<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta
  name="author"
  content="Malay Kalavadia, Rina Kim, Fahim Talukder, Jessica Tsai"
  />
  <title>Team 11</title>
  <link href="styles.css" rel="stylesheet" />
  <link
  href="https://fonts.googleapis.com/css2?family=Staatliches&display=swap"
  rel="stylesheet"
  />
  <link
  href="https://fonts.googleapis.com/css2?family=Architects+Daughter&display=swap"
  rel="stylesheet"
  />
  <link
  href="https://fonts.googleapis.com/css2?family=Yellowtail&display=swap"
  rel="stylesheet"
  />
  <!-- style css -->
  <link rel="stylesheet" href="style.css" />
  <!-- Responsive-->
  <link rel="stylesheet" href="responsive.css" />
  <script
  src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
  integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs="
  crossorigin="anonymous"
  ></script>
  <script src="https://d3js.org/d3.v4.min.js"></script>
</head>
<body>
  <div class="header">
    <h1 class="title-bar" href="index.html">Predicting Next Hits</h1>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li>Project Content</li>
        <li><a href="about_us.html">About Us</a></li>
        <li><a href="documentation.html">Documentation</a></li>
      </ul>
    </nav>
  </div>

  <div class="wrapper">
    <div class="container">
      <div class="chart_area">
        <table id="music_chart">
          <th>Number</th>
          <th>Song</th>
          <th>Artist</th>
          <th>Play</th>
        </table>
      </div>
    </div>
  </div>
</div>
<!-- <script src="script.js"></script> -->
<script type="modules">
import { getTok } from "/auth.js";
const token = getTok();
console.log("getTok");
</script>
<script src="https://sdk.scdn.co/spotify-player.js"></script>
<script type="modules"> //async await window load???

window.onSpotifyWebPlaybackSDKReady = async () => {
  console.log("-----------" + token);
  const player = await new Spotify.Player({
    name: 'Web Playback SDK Quick Start Player',
    getOAuthToken: callback => { callback(token); }
  });

  // Error handling
  player.addListener('initialization_error', ({ message }) => { console.error(message); });
  player.addListener('authentication_error', ({ message }) => { console.error(message); });
  player.addListener('account_error', ({ message }) => { console.error(message); });
  player.addListener('playback_error', ({ message }) => { console.error(message); });

  // Playback status updates
  player.addListener('player_state_changed', state => { console.log(state); });

  // Connect to the player!
  const conn = await player.connect();
  if (conn) {
    console.log("sdk connection successful")
  }
};

import { getTok } from "/auth.js";
const token = getTok();
console.log("getTok");


//read billboard_data
d3.csv("billboard_data.csv", function(data) {
  const jsonString = JSON.stringify(data);
  const jsonData = JSON.parse(jsonString);
  append_json(jsonData);
});

function append_json(data) {
  let table = document.getElementById("music_chart");
  data.forEach(function(object) {
    const tr = document.createElement("tr");
    tr.innerHTML = "<td>" + (parseInt(object.num, 10) + 1) + "</td>" +
    "<td>" + object.Songs + "</td>" +
    "<td>" + object.Artists + "</td>" +
    "<td>" + "<button class='button'></button>" + "</td>"; //insert artist_ID
    table.appendChild(tr);
  });
}
//
// document.getElementById("myBtn").addEventListener("click", myFunction);
//
// function myFunction() {
//   document.getElementById("demo").innerHTML = "Hello World";
// };


</script>
</body>
</html>
